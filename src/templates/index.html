<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreeChatGPT - Your Personal AI, Completely Free</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="dark-theme">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-comments"></i>
                <span>FreeChatGPT</span>
            </div>
            <button class="new-chat-btn" onclick="newChat()">
                <i class="fas fa-plus"></i> New Chat
            </button>
        </div>

        <div class="sidebar-content">
            <!-- Conversation tabs -->
            <div class="conversation-tabs" id="conversationTabs">
                <div class="tab-section-title">Today</div>
                <!-- Tabs will be populated here -->
            </div>
        </div>

        <div class="sidebar-footer">
            <div class="user-section">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-info">
                    <div class="user-name">833K-cpu</div>
                    <div class="system-status">
                        <span class="status-indicator" id="statusIndicator"></span>
                        <span id="statusText">Checking...</span>
                    </div>
                </div>
            </div>
            <button class="settings-btn" onclick="toggleSettings()">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Top Bar with Navigation Tabs -->
        <div class="top-bar">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('chat')">
                    <i class="fas fa-comments"></i> Chat
                </button>
                <button class="nav-tab" onclick="switchTab('virustotal')">
                    <i class="fas fa-shield-virus"></i> VirusTotal
                </button>
                <button class="nav-tab" onclick="switchTab('image-gen')">
                    <i class="fas fa-image"></i> Image Gen
                </button>
                <button class="nav-tab" onclick="switchTab('api')">
                    <i class="fas fa-code"></i> API
                </button>
            </div>

            <div class="model-selector">
                <select id="modelSelect" onchange="changeModel()">
                    <option value="llama3.2:3b">Llama 3.2 3B - General</option>
                </select>
                <button class="download-models-btn" onclick="showModelManager()">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>

        <!-- Chat Tab -->
        <div class="tab-content active" id="chatTab">
            <div class="chat-container" id="chatContainer">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-content">
                        <div class="welcome-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h1>FreeChatGPT</h1>
                        <p class="tagline">Your Personal AI, Completely Free</p>
                        <p class="subtitle">by 833K-cpu</p>
                        
                        <div class="system-specs">
                            <div class="spec-card">
                                <i class="fas fa-lock"></i>
                                <span>100% Private</span>
                            </div>
                            <div class="spec-card">
                                <i class="fas fa-infinity"></i>
                                <span>Unlimited Usage</span>
                            </div>
                            <div class="spec-card">
                                <i class="fas fa-bolt"></i>
                                <span>GPU Accelerated</span>
                            </div>
                        </div>

                        <div class="quick-prompts">
                            <h3>Try asking about:</h3>
                            <div class="prompt-categories">
                                <div class="category">
                                    <h4><i class="fas fa-lightbulb"></i> General & Learning</h4>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Explain quantum computing in simple terms')">
                                        <p>Explain quantum computing in simple terms</p>
                                    </div>
                                    <div class="prompt-card" onclick="sendQuickPrompt('What are the main causes of climate change?')">
                                        <p>What are the main causes of climate change?</p>
                                    </div>
                                </div>
                                
                                <div class="category">
                                    <h4><i class="fas fa-code"></i> Coding & Tech</h4>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Write a Python script to analyze CSV files')">
                                        <p>Write a Python script to analyze CSV files</p>
                                    </div>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Debug my JavaScript async/await code')">
                                        <p>Debug my JavaScript async/await code</p>
                                    </div>
                                </div>
                                
                                <div class="category">
                                    <h4><i class="fas fa-pen-fancy"></i> Creative Writing</h4>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Write a short sci-fi story about AI')">
                                        <p>Write a short sci-fi story about AI</p>
                                    </div>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Create a poem about nature and technology')">
                                        <p>Create a poem about nature and technology</p>
                                    </div>
                                </div>
                                
                                <div class="category">
                                    <h4><i class="fas fa-search"></i> Research & Analysis</h4>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Compare renewable energy sources')">
                                        <p>Compare renewable energy sources</p>
                                    </div>
                                    <div class="prompt-card" onclick="sendQuickPrompt('Analyze the impact of social media on society')">
                                        <p>Analyze the impact of social media on society</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Messages Container -->
                <div class="messages-container" id="messagesContainer" style="display: none;">
                    <!-- Messages will be appended here -->
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <div class="input-container">
                    <button class="attach-btn" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <input type="file" id="fileInput" style="display: none" onchange="handleFileSelect(event)" multiple accept=".txt,.pdf,.png,.jpg,.jpeg,.gif,.doc,.docx">
                    
                    <div class="attached-files" id="attachedFiles"></div>
                    
                    <textarea 
                        id="messageInput" 
                        placeholder="Message FreeChatGPT..."
                        rows="1"
                        onkeydown="handleKeyPress(event)"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                </div>
                <div class="input-footer">
                    <span class="powered-by">FreeChatGPT by 833K-cpu • Running locally • 100% Free Forever</span>
                </div>
            </div>
        </div>

        <!-- VirusTotal Tab -->
        <div class="tab-content" id="virustotalTab">
            <div class="vt-container">
                <div class="vt-header">
                    <i class="fas fa-shield-virus"></i>
                    <h2>VirusTotal File Scanner</h2>
                    <p>Scan files without downloading them to your system</p>
                </div>
                
                <div class="vt-api-key">
                    <label>VirusTotal API Key:</label>
                    <input type="text" id="vtApiKey" placeholder="Enter your VirusTotal API key">
                    <a href="https://www.virustotal.com/gui/join-us" target="_blank">Get Free API Key</a>
                </div>
                
                <div class="vt-upload-area" onclick="document.getElementById('vtFileInput').click()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h3>Drop file here or click to upload</h3>
                    <p>File will be scanned by VirusTotal, not downloaded</p>
                    <input type="file" id="vtFileInput" style="display: none" onchange="handleVTFileSelect(event)">
                </div>
                
                <div class="vt-results" id="vtResults" style="display: none;">
                    <!-- Scan results will appear here -->
                </div>
            </div>
        </div>

        <!-- Image Generation Tab -->
        <div class="tab-content" id="image-genTab">
            <div class="img-gen-container">
                <div class="img-gen-header">
                    <i class="fas fa-image"></i>
                    <h2>AI Image Generation</h2>
                    <p>Generate images using Stable Diffusion</p>
                </div>
                
                <div class="img-gen-setup">
                    <div class="setup-info">
                        <h3>Setup Required</h3>
                        <ol>
                            <li>Install <a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui" target="_blank">Stable Diffusion WebUI</a></li>
                            <li>Launch with <code>--api</code> flag</li>
                            <li>Configure endpoint below</li>
                        </ol>
                    </div>
                    
                    <div class="img-gen-config">
                        <label>Stable Diffusion API URL:</label>
                        <input type="text" id="sdApiUrl" value="http://localhost:7860" placeholder="http://localhost:7860">
                    </div>
                    
                    <div class="img-gen-prompt">
                        <textarea id="imgPrompt" placeholder="Describe the image you want to generate..." rows="4"></textarea>
                        <button class="generate-btn" onclick="generateImage()">
                            <i class="fas fa-magic"></i> Generate Image
                        </button>
                    </div>
                    
                    <div class="img-gen-result" id="imgGenResult"></div>
                </div>
            </div>
        </div>

        <!-- API Tab -->
        <div class="tab-content" id="apiTab">
            <div class="api-docs-container">
                <div class="api-header">
                    <i class="fas fa-code"></i>
                    <h2>API Documentation</h2>
                    <p>Use FreeChatGPT API in your applications</p>
                </div>
                
                <div class="api-section">
                    <h3>Base URL</h3>
                    <code class="code-block">http://localhost:5000/api</code>
                </div>
                
                <div class="api-section">
                    <h3>Chat Endpoint</h3>
                    <code class="code-block">POST /api/chat</code>
                    <pre class="code-example">{
  "message": "Your question here",
  "model": "llama3.2:3b",
  "history": []
}</pre>
                </div>
                
                <div class="api-section">
                    <h3>Python Example</h3>
                    <pre class="code-example">import requests

response = requests.post(
    'http://localhost:5000/api/chat',
    json={
        'message': 'Explain AI in simple terms',
        'model': 'llama3.2:3b'
    }
)

print(response.json())</pre>
                </div>
                
                <div class="api-section">
                    <h3>JavaScript Example</h3>
                    <pre class="code-example">const response = await fetch('http://localhost:5000/api/chat', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        message: 'Explain AI in simple terms',
        model: 'llama3.2:3b'
    })
});

const data = await response.json();</pre>
                </div>
                
                <div class="api-section">
                    <h3>Available Endpoints</h3>
                    <ul class="endpoint-list">
                        <li><code>GET /api/status</code> - Check system status</li>
                        <li><code>POST /api/chat</code> - Send chat message</li>
                        <li><code>POST /api/upload</code> - Upload file</li>
                        <li><code>GET /api/models</code> - List available models</li>
                        <li><code>GET /api/conversations</code> - Get saved chats</li>
                        <li><code>POST /api/virustotal/scan</code> - Scan with VirusTotal</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-btn" onclick="toggleSettings()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Appearance</h3>
                    <div class="setting-item">
                        <label>Theme</label>
                        <select id="themeSelect" onchange="changeTheme()">
                            <option value="dark">Dark</option>
                            <option value="light">Light</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>Chat Settings</h3>
                    <div class="setting-item">
                        <label>Auto-save conversations</label>
                        <input type="checkbox" id="autoSave" checked>
                    </div>
                    <div class="setting-item">
                        <label>Clear all conversations</label>
                        <button class="danger-btn" onclick="clearAllConversations()">Clear All</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>System Information</h3>
                    <div class="system-info" id="systemInfo">
                        <p><strong>Status:</strong> <span id="ollamaStatus">Checking...</span></p>
                        <p><strong>Models:</strong> <span id="installedModels">Loading...</span></p>
                        <p><strong>GPU:</strong> GTX 2060 (6GB VRAM)</p>
                        <p><strong>Version:</strong> 1.0.0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Model Manager Modal -->
    <div class="modal" id="modelManagerModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Model Manager</h2>
                <button class="close-btn" onclick="closeModelManager()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="model-categories">
                    <button class="category-btn active" onclick="filterModels('all')">All</button>
                    <button class="category-btn" onclick="filterModels('general')">General</button>
                    <button class="category-btn" onclick="filterModels('creative')">Creative</button>
                    <button class="category-btn" onclick="filterModels('fast')">Fast</button>
                </div>
                <div class="model-list" id="modelList">
                    <!-- Models will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
